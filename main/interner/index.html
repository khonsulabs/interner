<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="interner"><meta name="keywords" content="rust, rustlang, rust-lang, interner"><title>interner - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-6827029ac823cab7.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../static.files/light-ebce58d0a40c3431.css"><link rel="stylesheet" disabled href="../static.files/dark-f23faae4a2daf9a6.css"><link rel="stylesheet" disabled href="../static.files/ayu-8af5e100b21cd173.css"><script id="default-settings" ></script><script src="../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-c55e1eb52e1886b4.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../interner/index.html"><div class="logo-container"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../interner/index.html"><div class="logo-container"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate interner</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.1</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">interner</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/interner/lib.rs.html#1-219">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="interner"><a href="#interner">interner</a></h2>
<p><img src="https://img.shields.io/badge/unsafe-forbid-success" alt="interner forbids unsafe code" />
<a href="https://crates.io/crates/interner"><img src="https://img.shields.io/crates/v/interner.svg" alt="crate version" /></a>
<a href="https://github.com/khonsulabs/interner/actions?query=workflow:Tests"><img src="https://img.shields.io/github/actions/workflow/status/khonsulabs/interner/tests.yml?branch=main" alt="Live Build Status" /></a>
<a href="https://khonsulabs.github.io/interner/coverage/"><img src="https://khonsulabs.github.io/interner/coverage/badge.svg" alt="HTML Coverage Report for main branch" /></a>
<a href="https://khonsulabs.github.io/interner/main/interner"><img src="https://img.shields.io/badge/docs-main-informational" alt="Documentation" /></a></p>
<p>An interning crate for Rust with no dependencies and no unsafe code
(<code>#![forbid(unsafe_code)]</code>). Most existing interning crates only offer interning
strings. This crate allows interning paths and byte buffers as well.</p>
<h3 id="how-this-crate-works"><a href="#how-this-crate-works">How this crate works</a></h3>
<p>This crate uses a <code>HashSet</code> and a <code>Vec</code> to store its entries. When a value is
looked up, if it cannot be found in the <code>HashSet</code>, it is assigned a slot in the
<code>Vec</code>. Future lookups will return a clone to the <code>Arc</code>-wrapped data.</p>
<p>When the final reference to a <code>Pooled&lt;T&gt;</code> value is dropped, the pool’s <code>HashMap</code>
has the value removed and the <code>Vec</code>’s slot is made available for re-use.</p>
<p>This crate does not do sub-value interning. Each value is stored independently
with its own allocation.</p>
<h3 id="hash-for-pooled-values"><a href="#hash-for-pooled-values"><code>Hash</code> for Pooled Values</a></h3>
<p>The <code>Pooled&lt;T&gt;</code> type implements <code>Hash</code> by hashing its internal unique id rather
than using <code>T::hash()</code>. This allows pooled objects to be used as efficent keys
in hash maps and sets.</p>
<p>Because <code>T::hash()</code> is different than <code>Pooled&lt;T&gt;::hash()</code>, <code>Pooled&lt;T&gt;</code> does not
implement <code>Borrow&lt;T&gt;</code>. This prevents using an <code>&amp;str</code> to look up a value in a
<code>HashMap</code>.</p>
<p>Another important caveat of using <code>Pooled&lt;T&gt;</code> values as keys in a hash-based
collection is that all <code>Pooled&lt;T&gt;</code> values must be from the same pool. Using
values from separate pools will cause lookups to be unable to find the contained
keys in most situations. When using this unsupported flow, incorrect matches
will never occur because <code>Pooled&lt;T&gt;::eq()</code> is implemented to verify the values
are from the same pool, otherwise the underlying values are compared.</p>
<h3 id="globally-interned-strings"><a href="#globally-interned-strings">Globally Interned Strings</a></h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>interner::global::{GlobalString, GlobalPool};

<span class="kw">static </span>STRINGS: GlobalPool&lt;String&gt; = GlobalPool::new();

<span class="kw">let </span>my_string = STRINGS.get(<span class="string">&quot;hello&quot;</span>);
<span class="kw">let </span>other_copy = STRINGS.get(String::from(<span class="string">&quot;hello&quot;</span>));

<span class="comment">// Both `my_string` and `other_copy` are pointing to the same underlying string.
</span><span class="macro">assert!</span>(GlobalString::ptr_eq(<span class="kw-2">&amp;</span>my_string, <span class="kw-2">&amp;</span>other_copy));</code></pre></div>
<h3 id="interned-strings-from-a-stringpool"><a href="#interned-strings-from-a-stringpool">Interned Strings from a StringPool</a></h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>interner::shared::{StringPool, SharedString};

<span class="kw">let </span>pool = StringPool::default();
<span class="kw">let </span>my_string = pool.get(<span class="string">&quot;hello&quot;</span>);
<span class="kw">let </span>other_copy = pool.get(String::from(<span class="string">&quot;hello&quot;</span>));

<span class="comment">// Both `my_string` and `other_copy` are pointing to the same underlying string.
</span><span class="macro">assert!</span>(SharedString::ptr_eq(<span class="kw-2">&amp;</span>my_string, <span class="kw-2">&amp;</span>other_copy));</code></pre></div>
<h3 id="globally-interned-paths"><a href="#globally-interned-paths">Globally Interned Paths</a></h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::path::{Path, PathBuf};
<span class="kw">use </span>interner::global::{GlobalPath, GlobalPool};

<span class="kw">static </span>PATHS: GlobalPool&lt;PathBuf&gt; = GlobalPool::new();

<span class="kw">let </span>my_path = PATHS.get(Path::new(<span class="string">&quot;hello&quot;</span>));
<span class="kw">let </span>other_copy = PATHS.get(PathBuf::from(<span class="string">&quot;hello&quot;</span>));

<span class="comment">// Both `my_path` and `other_copy` are pointing to the same underlying path.
</span><span class="macro">assert!</span>(GlobalPath::ptr_eq(<span class="kw-2">&amp;</span>my_path, <span class="kw-2">&amp;</span>other_copy));</code></pre></div>
<h3 id="interned-paths-from-a-pathpool"><a href="#interned-paths-from-a-pathpool">Interned Paths from a PathPool</a></h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::path::{Path, PathBuf};
<span class="kw">use </span>interner::shared::{PathPool, SharedPath};

<span class="kw">let </span>pool = PathPool::default();
<span class="kw">let </span>my_string = pool.get(Path::new(<span class="string">&quot;hello&quot;</span>));
<span class="kw">let </span>other_copy = pool.get(PathBuf::from(<span class="string">&quot;hello&quot;</span>));

<span class="comment">// Both `my_path` and `other_copy` are pointing to the same underlying path.
</span><span class="macro">assert!</span>(SharedPath::ptr_eq(<span class="kw-2">&amp;</span>my_string, <span class="kw-2">&amp;</span>other_copy));</code></pre></div>
<h3 id="globally-interned-byte-buffers"><a href="#globally-interned-byte-buffers">Globally Interned Byte Buffers</a></h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>interner::global::{GlobalBuffer, GlobalPool};

<span class="kw">static </span>BUFFERS: GlobalPool&lt;Vec&lt;u8&gt;&gt; = GlobalPool::new();

<span class="kw">let </span>my_buffer = BUFFERS.get(<span class="kw-2">&amp;</span><span class="string">b&quot;hello&quot;</span>[..]);
<span class="kw">let </span>other_copy = BUFFERS.get(<span class="string">b&quot;hello&quot;</span>.to_vec());

<span class="comment">// Both `my_buffer` and `other_copy` are pointing to the same underlying path.
</span><span class="macro">assert!</span>(GlobalBuffer::ptr_eq(<span class="kw-2">&amp;</span>my_buffer, <span class="kw-2">&amp;</span>other_copy));</code></pre></div>
<h3 id="interned-byte-buffers-from-a-bufferpool"><a href="#interned-byte-buffers-from-a-bufferpool">Interned Byte Buffers from a BufferPool</a></h3>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>interner::shared::{BufferPool, SharedBuffer};

<span class="kw">let </span>pool = BufferPool::default();
<span class="kw">let </span>my_buffer = pool.get(<span class="kw-2">&amp;</span><span class="string">b&quot;hello&quot;</span>[..]);
<span class="kw">let </span>other_copy = pool.get(<span class="string">b&quot;hello&quot;</span>.to_vec());

<span class="comment">// Both `my_path` and `other_copy` are pointing to the same underlying path.
</span><span class="macro">assert!</span>(SharedBuffer::ptr_eq(<span class="kw-2">&amp;</span>my_buffer, <span class="kw-2">&amp;</span>other_copy));</code></pre></div>
<h3 id="open-source-licenses"><a href="#open-source-licenses">Open-source Licenses</a></h3>
<p>This project, like all projects from <a href="https://khonsulabs.com/">Khonsu Labs</a>, are
open-source. This repository is available under the <a href="./LICENSE-MIT">MIT License</a>
or the <a href="./LICENSE-APACHE">Apache License 2.0</a>.</p>
<p>To learn more about contributing, please see <a href="./CONTRIBUTING.md">CONTRIBUTING.md</a>.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="global/index.html" title="interner::global mod">global</a></div><div class="item-right docblock-short">Global interning pools.</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="shared/index.html" title="interner::shared mod">shared</a></div><div class="item-right docblock-short">Shared interning pools that have no global state.</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Pooled.html" title="interner::Pooled struct">Pooled</a></div><div class="item-right docblock-short">A type that ensures only one copy of each value exists in its pool, enabling
quicker lookups by not requiring full comparisons.</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.PoolKind.html" title="interner::PoolKind trait">PoolKind</a></div><div class="item-right docblock-short">A kind of interning pool. Currently there are only two types of pools:</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="interner" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.0 (fc594f156 2023-01-24)" data-search-js="search-444266647c4dba98.js" data-settings-js="settings-bebeae96e00e4617.js" data-settings-css="settings-af96d9e2fc13e081.css" ></div></body></html>